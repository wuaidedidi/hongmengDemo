import router from '@ohos.router';
import promptAction from '@ohos.promptAction';

@Entry
@Component
struct ProfilePage {
  @State username: string = 'ç”¨æˆ·å';
  @State avatar: string = '/common/images/default_avatar.png';
  @State showLogoutConfirm: boolean = false;

  aboutToAppear() {
    // åˆå§‹åŒ–é¡µé¢
  }

  handleLogout() {
    this.showLogoutConfirm = true;
  }

  confirmLogout() {
    // æ‰§è¡Œç™»å‡ºæ“ä½œ
    this.showLogoutConfirm = false;
    router.pushUrl({ url: 'pages/Login' });
  }

  build() {
    Stack() {
      Column() {
        // é¡¶éƒ¨æ ‡é¢˜æ 
        Row() {
          Image('/common/images/back.png')
            .width(24)
            .height(24)
            .margin({ left: 16 })
            .onClick(() => {
              router.back();
            })

          Text('æˆ‘çš„')
            .fontSize(20)
            .fontWeight(FontWeight.Bold)
            .fontColor('#333333')
            .margin({ left: 16 })

          Blank()

          Text('âš™ï¸')
            .fontSize(24)
            .fontColor('#333333')
            .margin({ right: 16 })
        }
        .width('100%')
        .height(56)
        .backgroundColor('#FFFFFF')

        // ä¸ªäººä¿¡æ¯å¡ç‰‡
        Column() {
          Row() {
            Image(this.avatar)
              .width(80)
              .height(80)
              .borderRadius(40)
              .margin({ right: 16 })

            Column() {
              Text(this.username)
                .fontSize(24)
                .fontWeight(FontWeight.Bold)
                .fontColor('#333333')
                .margin({ bottom: 8 })

              Text('ç‚¹å‡»ç¼–è¾‘ä¸ªäººä¿¡æ¯')
                .fontSize(14)
                .fontColor('#666666')
            }
            .alignItems(HorizontalAlign.Start)
            .justifyContent(FlexAlign.Center)
          }
          .width('100%')
          .padding(16)
        }
        .width('100%')
        .backgroundColor('#FFFFFF')
        .margin({ top: 16 })

        // åŠŸèƒ½åˆ—è¡¨
        Column() {
          // æ•°æ®ç»Ÿè®¡
          Row() {
            Text('ðŸ“Š')
              .fontSize(24)
              .fontColor('#333333')
              .margin({ right: 16 })

            Text('æ•°æ®ç»Ÿè®¡')
              .fontSize(16)
              .fontColor('#333333')

            Blank()

            Image('/common/images/arrow_right.png')
              .width(20)
              .height(20)
          }
          .width('100%')
          .height(56)
          .padding({ left: 16, right: 16 })
          .backgroundColor('#FFFFFF')
          .onClick(() => {
            router.pushUrl({ url: 'pages/StatisticsPage' });
          })

          Divider()
            .color('#F5F5F5')
            .width('100%')

          // ä¸»é¢˜è®¾ç½®
          Row() {
            Text('ðŸŽ¨')
              .fontSize(24)
              .fontColor('#333333')
              .margin({ right: 16 })

            Text('ä¸»é¢˜è®¾ç½®')
              .fontSize(16)
              .fontColor('#333333')

            Blank()

            Image('/common/images/arrow_right.png')
              .width(20)
              .height(20)
          }
          .width('100%')
          .height(56)
          .padding({ left: 16, right: 16 })
          .backgroundColor('#FFFFFF')
          .onClick(() => {
            router.pushUrl({ url: 'pages/BackgroundSettingsPage' });
          })

          Divider()
            .color('#F5F5F5')
            .width('100%')

          // é€šçŸ¥è®¾ç½®
          Row() {
            Text('ðŸ””')
              .fontSize(24)
              .fontColor('#333333')
              .margin({ right: 16 })

            Text('é€šçŸ¥è®¾ç½®')
              .fontSize(16)
              .fontColor('#333333')

            Blank()

            Image('/common/images/arrow_right.png')
              .width(20)
              .height(20)
          }
          .width('100%')
          .height(56)
          .padding({ left: 16, right: 16 })
          .backgroundColor('#FFFFFF')

          Divider()
            .color('#F5F5F5')
            .width('100%')

          // å…³äºŽæˆ‘ä»¬
          Row() {
            Text('â„¹ï¸')
              .fontSize(24)
              .fontColor('#333333')
              .margin({ right: 16 })

            Text('å…³äºŽæˆ‘ä»¬')
              .fontSize(16)
              .fontColor('#333333')

            Blank()

            Image('/common/images/arrow_right.png')
              .width(20)
              .height(20)
          }
          .width('100%')
          .height(56)
          .padding({ left: 16, right: 16 })
          .backgroundColor('#FFFFFF')
        }
        .width('100%')
        .margin({ top: 16 })

        // é€€å‡ºç™»å½•æŒ‰é’®
        Button('é€€å‡ºç™»å½•')
          .width('90%')
          .height(48)
          .fontSize(18)
          .fontColor('#FFFFFF')
          .backgroundColor('#FF4D4F')
          .borderRadius(24)
          .margin({ top: 32 })
          .onClick(() => {
            this.handleLogout();
          })
      }
      .width('100%')
      .height('100%')
      .backgroundColor('#F8F8F8')

      // é€€å‡ºç¡®è®¤å¯¹è¯æ¡†
      if (this.showLogoutConfirm) {
        Column() {
          Column() {
            Text('ç¡®è®¤é€€å‡ºï¼Ÿ')
              .fontSize(20)
              .fontWeight(FontWeight.Bold)
              .fontColor('#333333')
              .margin({ top: 24, bottom: 16 })

            Text('é€€å‡ºåŽå°†æ¸…é™¤ç™»å½•çŠ¶æ€')
              .fontSize(16)
              .fontColor('#666666')
              .margin({ bottom: 24 })

            Row() {
              Button('å–æ¶ˆ')
                .width('40%')
                .height(44)
                .fontSize(16)
                .fontColor('#333333')
                .backgroundColor('#F5F5F5')
                .borderRadius(22)
                .onClick(() => {
                  this.showLogoutConfirm = false;
                })

              Button('ç¡®è®¤é€€å‡º')
                .width('40%')
                .height(44)
                .fontSize(16)
                .fontColor('#FFFFFF')
                .backgroundColor('#FF4D4F')
                .borderRadius(22)
                .margin({ left: 16 })
                .onClick(() => {
                  this.confirmLogout();
                })
            }
            .margin({ bottom: 16 })
          }
          .width('90%')
          .backgroundColor('#FFFFFF')
          .borderRadius(16)
        }
        .width('100%')
        .height('100%')
        .backgroundColor('rgba(0, 0, 0, 0.5)')
        .justifyContent(FlexAlign.Center)
        .onClick(() => {
          this.showLogoutConfirm = false;
        })
      }
    }
    .width('100%')
    .height('100%')
  }
} 